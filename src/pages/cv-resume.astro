---
import Layout from '../layouts/Layout.astro';
import { getEntry } from 'astro:content';
import '../styles/print.css';
import PrintButton from '../components/PrintButton.astro';

// Wrap this in a try/catch to handle potential errors
let cvData;
try {
  const cv = await getEntry('cv', 'index');
  cvData = cv.data;
} catch (error) {
  console.error('Error loading CV data:', error);
  cvData = null;
}
---

<Layout title="CV/Resume | Brady Clarke" description="Brady Clarke's professional experience and skills">
  <link rel="stylesheet" href="/styles/print.css" media="print">
  <main class="cv-page">
    <h1>CV/Resume</h1>
    <PrintButton />
    {cvData ? (
      <div class="cv-content">
        <section class="cv-section">
          <h2>Professional Summary</h2>
          <p>{cvData.summary}</p>
        </section>

        <section class="cv-section">
          <h2>Work Experience</h2>
          {cvData.experience.map((job) => (
            <div class="cv-item">
              <h3>{job.title} at {job.company}</h3>
              <p class="cv-date">{job.startDate} - {job.endDate}</p>
              <ul>
                {job.responsibilities.map((resp) => (
                  <li>{resp}</li>
                ))}
              </ul>
            </div>
          ))}
        </section>

        <section class="cv-section">
          <h2>Skills</h2>
          <ul class="skills-list">
            {cvData.skills.map((skill) => (
              <li>{skill}</li>
            ))}
          </ul>
        </section>

        <section class="cv-section">
          <h2>Education</h2>
          {cvData.education.map((edu) => (
            <div class="cv-item">
              <h3>{edu.degree} in {edu.field}</h3>
              <p>{edu.institution}, {edu.graduationYear}</p>
            </div>
          ))}
        </section>
      </div>
    ) : (
      <p>CV data is currently unavailable. Just check my LinkedIn for now and maybe let me know? :)</p>
    )}
  </main>
</Layout>
